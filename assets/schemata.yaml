# TODO @Jim fix any problems in here, and add missing formats
#   see:  parser_*.rb definitions in https://github.com/fluent/fluentd/tree/master/lib/fluent/plugin
#         https://docs.fluentd.org/v/0.12/articles/common-log-formats
#   see:  more format info in https://www.graylog.org/post/log-formats-a-complete-guide

logstash:
  format: json
  priority: 100
  predicates:
    "@version": "^1$"
  mapping:
    timestamp: "@timestamp"
    level: level
    application: application
    context: thread_name
    entity: class
    action: method
    line: line_number
    message: message
    error: exception.stacktrace

cloudwatch-event:
  format: json
  predicates:
    tag: "^cloud-watch$"
  mapping:
    timestamp: "@timestamp"
    application: tag
    context: id
    entity: logGroup
    action: logStream
    message: log

ecs:
  format: json
  predictes:
    "@timestamp": "^.+$"
    container_name: "^.+$"
  mapping:
    timestamp: "@timestamp"
    application: container_name
    message: log
    context: vpc_id
    entity: environment
    action: instance_id

aws-billing-report:
  format: text
  priority: 90
  predicates:
    _: "^(?P<message>REPORT (?P<entity>RequestId):\\s+(?P<action>\\S+)\\s+.+)(?P<level>)(?P<context>)(?P<line>)(?P<application>)(?P<timestamp>)(?P<error>)$"

aws-billing-start:
  format: text
  priority: 90
  predicates:
    _: "^(?P<message>START (?P<entity>RequestId):(?P<action>\\s+\\S+).+)(?P<level>)(?P<context>)(?P<line>)(?P<application>)(?P<timestamp>)(?P<error>)$"

aws-billing-end:
  format: text
  priority: 90
  predicates:
    _: "^(?P<message>END (?P<entity>RequestId):\\s+(?P<action>\\S+)\\s+.+)(?P<level>)(?P<context>)(?P<line>)(?P<application>)(?P<timestamp>)(?P<error>)$"
