logstash:
  format: json
  priority: 100
  predicates:
    "@version": "^1$"
  mapping:
    timestamp: "@timestamp"
    level: level
    application: application
    thread: thread_name
    class: class
    method: method
    line: line_number
    message: message
    exception: exception.stacktrace

cloudwatch-event:
  format: json
  predicates:
    tag: "^cloud-watch$"
  mapping:
    timestamp: "@timestamp"
    application: tag
    thread: id
    class: logGroup
    method: logStream
    message: log

ecs:
  format: json
  predictes:
    "@timestamp": "^.+$"
    container_name: "^.+$"
  mapping:
    timestamp: "@timestamp"
    application: container_name
    message: log
    thread: vpc_id
    class: environment
    method: instance_id

aws-billing-report:
  format: text
  priority: 90
  predicates:
    _: "^(?P<message>REPORT (?P<class>RequestId):\\s+(?P<method>\\S+)\\s+.+)(?P<level>)(?P<thread>)(?P<line>)(?P<application>)(?P<timestamp>)(?P<exception>)$"

aws-billing-start:
  format: text
  priority: 90
  predicates:
    _: "^(?P<message>START (?P<class>RequestId):(?P<method>\\s+\\S+).+)(?P<level>)(?P<thread>)(?P<line>)(?P<application>)(?P<timestamp>)(?P<exception>)$"

aws-billing-end:
  format: text
  priority: 90
  predicates:
    _: "^(?P<message>END (?P<class>RequestId):\\s+(?P<method>\\S+)\\s+.+)(?P<level>)(?P<thread>)(?P<line>)(?P<application>)(?P<timestamp>)(?P<exception>)$"
